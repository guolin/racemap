# æµ·ä¸Šç¨³å®šæ€§ä¼˜åŒ–å’Œæ¶æ„ç®€åŒ–æ–¹æ¡ˆ

## æ¦‚è¿°

é’ˆå¯¹æµ·ä¸Šä¿¡å·ä¸ç¨³å®šç¯å¢ƒï¼Œé‡æ–°æ¢³ç†ç³»ç»Ÿæ¶æ„ï¼Œè§£å†³åœ¨çº¿ç»Ÿè®¡æ··ä¹±é—®é¢˜ï¼Œå¢å¼º MQTT/GPS ç¨³å®šæ€§ï¼ŒåŒæ—¶ç®€åŒ–éæ ¸å¿ƒåŠŸèƒ½ã€‚

## æ ¸å¿ƒåŸåˆ™

1. **å¯é æ€§ä¼˜å…ˆ** - æµ·ä¸Šç¯å¢ƒä¸å…è®¸å¤±è´¥
2. **é€»è¾‘ç»Ÿä¸€** - é¿å…ç®¡ç†å‘˜/è§‚å¯Ÿè€…åŒé‡æœºåˆ¶
3. **ç®€åŒ–éæ ¸å¿ƒ** - ä¸“æ³¨ç¨³å®šæ€§ï¼Œç§»é™¤è¿‡åº¦è®¾è®¡

## ä¸»è¦é—®é¢˜åˆ†æ

### ğŸš¨ åœ¨çº¿ç»Ÿè®¡é€»è¾‘æ··ä¹±
- **ç®¡ç†å‘˜ä¸åœ¨ç»Ÿè®¡ä¸­** - å‘å¸ƒåˆ°ä¸åŒä¸»é¢˜ (`admin` vs `observer/*`)
- **è‡ªå·±ä¸åœ¨ç»Ÿè®¡ä¸­** - `useObserversPos` è·³è¿‡è‡ªå·±çš„æ¶ˆæ¯
- **æ¸…ç†æœºåˆ¶ä¸ä¸€è‡´** - ç®¡ç†å‘˜5åˆ†é’ŸTTL vs è§‚å¯Ÿè€…60ç§’æ¸…ç†
- **ç»“æœé”™è¯¯** - 1ç®¡ç†å‘˜+2è§‚å¯Ÿè€…æ˜¾ç¤º1äººåœ¨çº¿

### ğŸš¨ MQTT ç¨³å®šæ€§ä¸è¶³
- **é‡è¿é™åˆ¶è¿‡ä¸¥** - 5æ¬¡é‡è¿åæ°¸ä¹…æ”¾å¼ƒ
- **é‡è¿é—´éš”è¿‡çŸ­** - 2ç§’é—´éš”æ¶ˆè€—ç”µé‡
- **æµ·ä¸Šåœºæ™¯ä¸é€‚é…** - ä¿¡å·å¯èƒ½æ–­è¿å¾ˆä¹…

### ğŸš¨ GPS ç²¾åº¦è¦æ±‚ä¸ä¸¥
- **æ— ç²¾åº¦è¿‡æ»¤** - å¯èƒ½æ¥å—ä½ç²¾åº¦æ•°æ®
- **è¶…æ—¶è®¾ç½®ä¿å®ˆ** - 10ç§’å¯¹æµ·ä¸ŠGPSåçŸ­

## è§£å†³æ–¹æ¡ˆ

### 1. ç»Ÿä¸€åœ¨çº¿çŠ¶æ€ç®¡ç† ğŸ¯

#### æ–°çš„ä¸»é¢˜ç»“æ„
```
æ—§: race/{raceId}/location/admin          (ç®¡ç†å‘˜)
æ—§: race/{raceId}/location/observer/{id}  (è§‚å¯Ÿè€…)

æ–°: race/{raceId}/presence/{userId}       (æ‰€æœ‰äººç»Ÿä¸€)
```

#### ç»Ÿä¸€æ¶ˆæ¯æ ¼å¼
```typescript
{
  id: "ADMIN" | "observer_xxx",
  role: "admin" | "observer",
  lat: number,
  lng: number,
  heading?: number,
  course?: { type: string, params: any }, // ä»…ç®¡ç†å‘˜
  ts: number
}
```

#### å®æ–½æ–‡ä»¶

**1. ä¿®æ”¹ç®¡ç†å‘˜å‘å¸ƒ** - `src/features/mqtt/hooks/useMqttPosSync.ts`
```typescript
// ç¬¬18è¡Œï¼Œä¿®æ”¹topicå‡½æ•°
const presenceTopic = (id: string) => `race/${id}/presence/ADMIN`;

// ç¬¬99è¡Œï¼Œä¿®æ”¹å‘å¸ƒé€»è¾‘
const payloadStr = JSON.stringify({
  id: 'ADMIN',
  role: 'admin',
  lat: pos.lat,
  lng: pos.lng,
  course: { type, params },
  ts: now
});
client.publish(presenceTopic(courseId), payloadStr, { retain: true, qos: 1 });
```

**2. ä¿®æ”¹è§‚å¯Ÿè€…å‘å¸ƒ** - `src/features/mqtt/service.ts`
```typescript
// ç¬¬92-111è¡Œï¼Œä¿®æ”¹ publishObserverPos å‡½æ•°
export function publishObserverPos(raceId: string, observerId: string, pos: ObserverPosition) {
  const c = getMqttClient();
  if (!c || !c.connected) return;

  const topic = `race/${raceId}/presence/${observerId}`;
  const payload = JSON.stringify({
    id: observerId,
    role: 'observer',
    lat: pos.lat,
    lng: pos.lng,
    heading: pos.heading,
    ts: Date.now()
  });

  c.publish(topic, payload, {
    qos: 0,
    retain: true,
    properties: { messageExpiryInterval: 60 } // ç»Ÿä¸€60ç§’è¿‡æœŸ
  });
}
```

**3. æ–°å»ºç»Ÿä¸€çš„åœ¨çº¿ç”¨æˆ·Hook** - `src/features/mqtt/hooks/useOnlineUsers.ts`
```typescript
import { useEffect, useState } from 'react';
import { useMqttClient } from '../hooks';

export interface OnlineUser {
  id: string;
  role: 'admin' | 'observer';
  lat: number;
  lng: number;
  heading?: number;
  course?: { type: string; params: any };
  ts: number;
}

export function useOnlineUsers(raceId: string, currentUserId: string) {
  const client = useMqttClient();
  const [users, setUsers] = useState<Record<string, OnlineUser>>({});

  useEffect(() => {
    if (!client) return;

    const topicFilter = `race/${raceId}/presence/+`;

    const onMsg = (topic: string, payload: Uint8Array) => {
      try {
        const userId = topic.split('/').pop()!;
        const data = JSON.parse(new TextDecoder().decode(payload));

        setUsers(prev => {
          const now = Date.now();
          // ç»Ÿä¸€60ç§’è¿‡æœŸæ¸…ç†
          const cleaned: Record<string, OnlineUser> = {};
          Object.entries(prev).forEach(([id, user]) => {
            if (now - user.ts < 60_000) {
              cleaned[id] = user;
            }
          });

          // æ·»åŠ /æ›´æ–°ç”¨æˆ·ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰
          cleaned[userId] = {
            id: data.id,
            role: data.role,
            lat: data.lat,
            lng: data.lng,
            heading: data.heading,
            course: data.course,
            ts: data.ts
          };

          return cleaned;
        });
      } catch (e) {
        console.error('[useOnlineUsers] Parse error:', e);
      }
    };

    client.subscribe(topicFilter, { qos: 0 });
    client.on('message', onMsg);

    return () => {
      client.unsubscribe(topicFilter);
      client.off('message', onMsg);
    };
  }, [client, raceId]);

  const allUsers = Object.values(users);
  return {
    allUsers,
    onlineCount: allUsers.length,
    otherUsers: allUsers.filter(u => u.id !== currentUserId),
    admin: allUsers.find(u => u.role === 'admin'),
    observers: allUsers.filter(u => u.role === 'observer')
  };
}
```

**4. æ›´æ–° RaceMap ç»„ä»¶** - `src/features/map/RaceMap.tsx`
```typescript
// ç¬¬263-270è¡Œï¼Œæ›¿æ¢ç°æœ‰é€»è¾‘
import { useOnlineUsers } from '@features/mqtt/hooks/useOnlineUsers';

// æ›¿æ¢ useObserversPos ä¸ºæ–°çš„ç»Ÿä¸€hook
const { allUsers, onlineCount, otherUsers, admin } = useOnlineUsers(
  courseId, 
  isAdmin ? 'ADMIN' : observerIdRef.current
);

// ç¬¬295è¡Œï¼Œä¿æŒç°æœ‰æ˜¾ç¤ºé€»è¾‘
right={<OnlineCount count={onlineCount} />}

// ç¬¬305è¡Œï¼Œæ›´æ–°è§‚å¯Ÿè€…åˆ—è¡¨
<ObserversList observers={otherUsers} currentObserverId={isAdmin ? 'ADMIN' : observerIdRef.current} />
```

### 2. å¼ºåŒ– MQTT ç¨³å®šæ€§ ğŸ”§

**æ–‡ä»¶**: `src/features/mqtt/service.ts`

```typescript
// ç¬¬29-38è¡Œï¼Œä¼˜åŒ–è¿æ¥å‚æ•°
const options: IClientOptions = {
  reconnectPeriod: 8000,   // 8ç§’é‡è¿é—´éš”ï¼Œé¿å…é¢‘ç¹é‡è¿
  connectTimeout: 15000,   // 15ç§’è¿æ¥è¶…æ—¶
  keepalive: 30,           // 30ç§’å¿ƒè·³ï¼ŒèŠ‚çœæµé‡
  clean: true,
  clientId: `rc_${Math.random().toString(16).slice(2, 10)}`,
  username: process.env.NEXT_PUBLIC_MQTT_USERNAME,
  password: process.env.NEXT_PUBLIC_MQTT_PASSWORD,
  protocolVersion: 5,
};

// ç¬¬47-53è¡Œï¼Œç§»é™¤é‡è¿é™åˆ¶
c.on('reconnect', () => {
  console.warn('[MQTT] reconnectingâ€¦ count:', ++reconnectCount);
  // âŒ åˆ é™¤è¿™æ®µä»£ç ï¼Œå…è®¸æ— é™é‡è¿
  // if (reconnectCount > 5) {
  //   console.error('[MQTT] too many reconnection attempts, closing connection');
  //   c.end(true);
  //   client = null;
  // }
});
```

### 3. å¼ºåŒ– GPS ç²¾åº¦æ§åˆ¶ ğŸ¯

**æ–‡ä»¶**: `src/features/map/hooks/useGpsWatch.ts`

```typescript
// ç¬¬75-79è¡Œï¼Œä¼˜åŒ–GPSé…ç½®
watchIdRef.current = navigator.geolocation.watchPosition(handler, errorHandler, {
  enableHighAccuracy: true,
  maximumAge: 0,          // ä¸å…è®¸ç¼“å­˜ï¼Œç¡®ä¿æ•°æ®æ–°é²œ
  timeout: 20000,         // 20ç§’è¶…æ—¶ï¼Œç»™æµ·ä¸ŠGPSæ›´å¤šæ—¶é—´
});

// ç¬¬40è¡Œåï¼Œæ·»åŠ ç²¾åº¦è¿‡æ»¤
const handler = (pos: GeolocationPosition) => {
  const { latitude, longitude, heading, speed, accuracy } = pos.coords as GeolocationCoordinates & { heading: number };
  
  // ä¸¥æ ¼ç²¾åº¦è¦æ±‚ï¼šæ‹’ç»ä½ç²¾åº¦æ•°æ®
  if (accuracy && accuracy > 10) {
    console.debug('[GPS] Position rejected: accuracy', accuracy, 'm');
    return; // æ²¡æœ‰æ•°æ®å¥½è¿‡é”™è¯¯æ•°æ®
  }
  
  // åˆç†æ€§æ£€æŸ¥ï¼šé˜²æ­¢GPSè·³ç‚¹
  if (lastLatLngRef.current) {
    const distance = lastLatLngRef.current.distanceTo(L.latLng(latitude, longitude));
    if (distance > 500) { // 500ç±³è·³è·ƒæ£€æµ‹
      console.debug('[GPS] Position rejected: unrealistic jump', distance, 'm');
      return;
    }
  }

  const latlng = L.latLng(latitude, longitude);
  // ... å…¶ä½™é€»è¾‘ä¿æŒä¸å˜
};

// ç¬¬71-73è¡Œï¼Œä¼˜åŒ–é”™è¯¯å¤„ç†
const errorHandler = (err: GeolocationPositionError) => {
  let errorMessage = '';
  switch (err.code) {
    case 1: errorMessage = 'GPSæƒé™è¢«æ‹’ç»ï¼Œè¯·åœ¨è®¾ç½®ä¸­å…è®¸ä½ç½®è®¿é—®'; break;
    case 2: errorMessage = 'GPSä¿¡å·å¼±ï¼Œè¯·ç§»åŠ¨åˆ°å¼€é˜”ä½ç½®'; break;
    case 3: errorMessage = 'GPSå®šä½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥GPSè®¾ç½®'; break;
    default: errorMessage = `GPSé”™è¯¯: ${err.message}`;
  }
  setState((s) => ({ ...s, ok: false, errorMsg: errorMessage }));
};
```

### 4. æ¶æ„ç®€åŒ– âœ‚ï¸

#### åˆ é™¤è¿‡åº¦è®¾è®¡
1. **å¤šè¯­è¨€ç³»ç»Ÿç®€åŒ–** - åˆ é™¤ `CoursePluginI18n`ï¼Œæ”¹ä¸ºç®€å•å¯¹è±¡æ˜ å°„
2. **UIåº“ç²¾ç®€** - ç§»é™¤ `next-themes`ï¼Œä¿ç•™æ ¸å¿ƒ shadcn/ui ç»„ä»¶
3. **Hookæ•´åˆ** - åˆå¹¶ç›¸å…³åŠŸèƒ½ï¼Œå‡å°‘æ–‡ä»¶æ•°é‡

#### ä¿ç•™å¿…è¦è®¾è®¡
1. **èˆªçº¿æ’ä»¶ç³»ç»Ÿ** - 10ä¸ªèˆªçº¿ç±»å‹éœ€è¦é…ç½®ç³»ç»Ÿ
2. **Hookæ‹†åˆ†** - GPS/MQTT ç¨³å®šæ€§éœ€è¦ç‹¬ç«‹é”™è¯¯å¤„ç†
3. **é”™è¯¯å¤„ç†æœºåˆ¶** - æµ·ä¸Šç¯å¢ƒå¿…éœ€

### 5. æ¸…ç†å†—ä½™æ–‡ä»¶

```bash
# åˆ é™¤ä¸å†éœ€è¦çš„æ–‡ä»¶
rm src/features/mqtt/hooks/useObserversPos.ts
rm src/features/mqtt/hooks/useObserverPosPublish.ts

# ç®€åŒ–å¤šè¯­è¨€æ–‡ä»¶
# ä¿ç•™åŸºæœ¬ç¿»è¯‘ï¼Œç§»é™¤å¤æ‚çš„æ’ä»¶i18nç³»ç»Ÿ
```

## åŠŸèƒ½æ‘˜è¦

### ä¿®å¤åŠŸèƒ½ âœ…
1. **åœ¨çº¿ç»Ÿè®¡å‡†ç¡®** - æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼ˆç®¡ç†å‘˜+è§‚å¯Ÿè€…+è‡ªå·±ï¼‰
2. **MQTTæ— é™é‡è¿** - æµ·ä¸Šä¿¡å·æ–­è¿ä¹Ÿèƒ½æ¢å¤
3. **GPSé«˜ç²¾åº¦è¿‡æ»¤** - æ‹’ç»>10ç±³ç²¾åº¦çš„æ•°æ®
4. **ç»Ÿä¸€çŠ¶æ€ç®¡ç†** - æ‰€æœ‰äººä½¿ç”¨ç›¸åŒçš„presenceæœºåˆ¶

### ä¿æŒåŠŸèƒ½ âœ…
1. **èˆªçº¿é…ç½®ç³»ç»Ÿ** - æ”¯æŒ10ç§èˆªçº¿ç±»å‹æ‰©å±•
2. **å®æ—¶ä½ç½®åŒæ­¥** - ç®¡ç†å‘˜å’Œè§‚å¯Ÿè€…ä½ç½®å®æ—¶æ›´æ–°
3. **ç½‘ç»œçŠ¶æ€ç›‘æ§** - æ˜¾ç¤ºè¿æ¥çŠ¶æ€å’Œä¿¡å·å¼ºåº¦
4. **ç¦»çº¿å®¹é”™** - ç½‘ç»œæ¢å¤åè‡ªåŠ¨é‡è¿

### ç®€åŒ–åŠŸèƒ½ âœ‚ï¸
1. **ç§»é™¤å¤æ‚å¤šè¯­è¨€** - æ”¹ä¸ºç®€å•å¯¹è±¡æ˜ å°„
2. **ç²¾ç®€UIç»„ä»¶** - ç§»é™¤ä¸»é¢˜åˆ‡æ¢ç­‰éæ ¸å¿ƒåŠŸèƒ½
3. **å‡å°‘Hookæ–‡ä»¶** - åˆå¹¶ç›¸å…³åŠŸèƒ½

## å®æ–½ä¼˜å…ˆçº§

åŸºäºä»£ç å®¡æŸ¥åé¦ˆï¼Œé‡‡ç”¨**åˆ†é˜¶æ®µæ¸è¿›å¼å®æ–½**ç­–ç•¥ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ï¼š

### ğŸ§ª é˜¶æ®µ1ï¼šæ–¹æ¡ˆéªŒè¯ï¼ˆä½é£é™©ï¼Œ1-2å¤©ï¼‰
**ç›®æ ‡**ï¼šéªŒè¯æ–°é€»è¾‘æ­£ç¡®æ€§ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½

1. **åˆ›å»ºæ–°çš„ç»Ÿä¸€Hook** - `src/features/mqtt/hooks/useOnlineUsers.ts`
   - è®¢é˜…æ–°æ—§ä¸¤å¥—ä¸»é¢˜æ ¼å¼ï¼ˆå…¼å®¹æ€§å¤„ç†ï¼‰
   - åœ¨ RaceMap ä¸­å¹¶è¡Œè¿è¡Œæ–°æ—§é€»è¾‘
   - é€šè¿‡æ§åˆ¶å°æ—¥å¿—å¯¹æ¯”ç»Ÿè®¡ç»“æœ

2. **éªŒè¯ç»Ÿè®¡å‡†ç¡®æ€§**
   - æµ‹è¯•åœºæ™¯ï¼š1ç®¡ç†å‘˜ + 2è§‚å¯Ÿè€…
   - é¢„æœŸç»“æœï¼šæ–°é€»è¾‘æ˜¾ç¤º3äººï¼Œæ—§é€»è¾‘æ˜¾ç¤º1äºº
   - ç¡®ä¿æ–°é€»è¾‘åŒ…å«ç®¡ç†å‘˜å’Œè‡ªå·±

### ğŸ”„ é˜¶æ®µ2ï¼šé€æ­¥åˆ‡æ¢ï¼ˆä¸­é£é™©ï¼Œ3-5å¤©ï¼‰
**ç›®æ ‡**ï¼šé€ä¸ªæ›¿æ¢å‘å¸ƒå’Œç»Ÿè®¡é€»è¾‘

1. **åˆ‡æ¢åœ¨çº¿ç»Ÿè®¡é€»è¾‘**
   - RaceMap.tsx ç¬¬262-270è¡Œï¼šæ›¿æ¢ `useObserversPos` ä¸º `useOnlineUsers`
   - ä¿ç•™è§‚å¯Ÿè€…åˆ—è¡¨æ˜¾ç¤ºåŠŸèƒ½
   - éªŒè¯åœ¨çº¿è®¡æ•°å‡†ç¡®æ€§

2. **ä¿®æ”¹ç®¡ç†å‘˜å‘å¸ƒé€»è¾‘**
   - useMqttPosSync.ts ç¬¬18è¡Œï¼šä¿®æ”¹ topic å‡½æ•°
   - useMqttPosSync.ts ç¬¬99è¡Œï¼šä¿®æ”¹ payload æ ¼å¼ï¼Œæ·»åŠ  role å­—æ®µ
   - ç¡®ä¿ç®¡ç†å‘˜å‡ºç°åœ¨åœ¨çº¿åˆ—è¡¨ä¸­

3. **ä¿®æ”¹è§‚å¯Ÿè€…å‘å¸ƒé€»è¾‘**
   - service.ts ç¬¬100è¡Œï¼šä¿®æ”¹è§‚å¯Ÿè€… topic
   - ç»Ÿä¸€æ¶ˆæ¯æ ¼å¼å’Œè¿‡æœŸæ—¶é—´ï¼ˆ60ç§’ï¼‰
   - éªŒè¯è§‚å¯Ÿè€…æ­£å¸¸æ˜¾ç¤º

### âš¡ é˜¶æ®µ3ï¼šç¨³å®šæ€§ä¼˜åŒ–ï¼ˆä½é£é™©ï¼Œ2-3å¤©ï¼‰
**ç›®æ ‡**ï¼šå¢å¼ºæµ·ä¸Šç¯å¢ƒç¨³å®šæ€§

1. **MQTT æ— é™é‡è¿**
   - service.ts ç¬¬47-53è¡Œï¼šç§»é™¤5æ¬¡é‡è¿é™åˆ¶
   - è°ƒæ•´é‡è¿å‚æ•°ï¼ˆ8ç§’é—´éš”ï¼Œ15ç§’è¶…æ—¶ï¼‰

2. **GPS ç²¾åº¦æ§åˆ¶**
   - useGpsWatch.tsï¼šæ·»åŠ 10ç±³ç²¾åº¦è¿‡æ»¤
   - æ·»åŠ 500ç±³è·³è·ƒæ£€æµ‹
   - ä¼˜åŒ–è¶…æ—¶å’Œé”™è¯¯å¤„ç†

3. **æ¸…ç†æ—§ä»£ç **
   - åˆ é™¤ `useObserversPos.ts` å’Œ `useObserverPosPublish.ts`
   - ç§»é™¤å…¼å®¹æ€§ä»£ç 
   - ç®€åŒ–æ¶æ„

### ğŸ” é˜¶æ®µ4ï¼šæ¶æ„ç®€åŒ–ï¼ˆä½é£é™©ï¼ŒæŒ‰éœ€è¿›è¡Œï¼‰
1. ç®€åŒ–å¤šè¯­è¨€ç³»ç»Ÿ
2. ç²¾ç®€UIç»„ä»¶
3. åˆå¹¶ç›¸å…³Hookæ–‡ä»¶

## å®æ–½é£é™©æ§åˆ¶

### ğŸ›¡ï¸ å…¼å®¹æ€§å¤„ç†
æ–°çš„ `useOnlineUsers` Hook éœ€è¦åŒæ—¶æ”¯æŒæ–°æ—§ä¸»é¢˜æ ¼å¼ï¼š
```typescript
// å…¼å®¹æ—§æ ¼å¼
`race/${raceId}/location/admin`          // ç®¡ç†å‘˜
`race/${raceId}/location/observer/*`     // è§‚å¯Ÿè€…

// æ”¯æŒæ–°æ ¼å¼  
`race/${raceId}/presence/*`              // ç»Ÿä¸€æ ¼å¼
```

### ğŸ§ª æµ‹è¯•éªŒè¯ç­–ç•¥
1. **å¹¶è¡Œè¿è¡Œ**ï¼šæ–°æ—§é€»è¾‘åŒæ—¶è¿è¡Œï¼Œå¯¹æ¯”ç»“æœ
2. **æ—¥å¿—ç›‘æ§**ï¼šè¯¦ç»†è®°å½•ç»Ÿè®¡å·®å¼‚å’Œå¼‚å¸¸æƒ…å†µ
3. **å›æ»šæœºåˆ¶**ï¼šå‡ºç°é—®é¢˜å¯å¿«é€Ÿå›é€€åˆ°åŸæœ‰é€»è¾‘

### ğŸ“‹ å…³é”®éªŒè¯ç‚¹
| æµ‹è¯•åœºæ™¯ | æ—§é€»è¾‘æ˜¾ç¤º | æ–°é€»è¾‘é¢„æœŸ | éªŒè¯é‡ç‚¹ |
|----------|------------|------------|----------|
| 1ç®¡ç†å‘˜ | 0äºº | 1äºº | ç®¡ç†å‘˜ç»Ÿè®¡ |
| 1ç®¡ç†å‘˜+2è§‚å¯Ÿè€… | 1äºº | 3äºº | å®Œæ•´ç»Ÿè®¡ |
| 3è§‚å¯Ÿè€… | 2äºº | 3äºº | è‡ªå·±ç»Ÿè®¡ |
| ç”¨æˆ·ç¦»çº¿ | å»¶è¿Ÿæ¸…ç† | 60ç§’ç»Ÿä¸€æ¸…ç† | æ¸…ç†æœºåˆ¶ |

## é¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å | å®æ–½é˜¶æ®µ |
|------|--------|--------|----------|
| åœ¨çº¿ç»Ÿè®¡å‡†ç¡®æ€§ | âŒ é”™è¯¯ | âœ… å‡†ç¡® | é˜¶æ®µ1-2 |
| MQTTé‡è¿èƒ½åŠ› | 5æ¬¡åæ”¾å¼ƒ | æ— é™é‡è¿ | é˜¶æ®µ3 |
| GPSæ•°æ®è´¨é‡ | æ¥å—ä»»ä½•ç²¾åº¦ | æ‹’ç»>10mç²¾åº¦ | é˜¶æ®µ3 |
| ä»£ç å¤æ‚åº¦ | 41æ–‡ä»¶ | ~35æ–‡ä»¶ | é˜¶æ®µ4 |
| ç»´æŠ¤éš¾åº¦ | å¤æ‚ | ç®€åŒ– | å…¨é˜¶æ®µ |
| å®æ–½é£é™© | - | ä½é£é™©æ¸è¿› | åˆ†é˜¶æ®µæ§åˆ¶ |

## æˆåŠŸæ ‡å‡†

### é˜¶æ®µ1æˆåŠŸæ ‡å‡†
- [ ] æ–°é€»è¾‘æ­£ç¡®ç»Ÿè®¡æ‰€æœ‰ç”¨æˆ·ï¼ˆåŒ…æ‹¬ç®¡ç†å‘˜å’Œè‡ªå·±ï¼‰
- [ ] å…¼å®¹æ€§å¤„ç†æ— å¼‚å¸¸
- [ ] æ§åˆ¶å°æ—¥å¿—æ˜¾ç¤ºç»Ÿè®¡å·®å¼‚

### é˜¶æ®µ2æˆåŠŸæ ‡å‡†  
- [ ] åœ¨çº¿è®¡æ•°å‡†ç¡®æ˜¾ç¤º
- [ ] ç®¡ç†å‘˜å‡ºç°åœ¨åœ¨çº¿åˆ—è¡¨
- [ ] è§‚å¯Ÿè€…åˆ—è¡¨æ­£å¸¸å·¥ä½œ
- [ ] æ— åŠŸèƒ½å›é€€

### é˜¶æ®µ3æˆåŠŸæ ‡å‡†
- [ ] MQTT è¿æ¥åœ¨ä¿¡å·å·®ç¯å¢ƒä¸‹èƒ½æŒç»­é‡è¿
- [ ] GPS åªæ¥å—é«˜ç²¾åº¦ä½ç½®æ•°æ®ï¼ˆâ‰¤10mï¼‰
- [ ] ç³»ç»Ÿåœ¨æµ·ä¸Šç¯å¢ƒç¨³å®šè¿è¡Œ

è¿™ä¸ª**åˆ†é˜¶æ®µæ¸è¿›å¼æ–¹æ¡ˆ**ç¡®ä¿åœ¨ä¼˜åŒ–ç³»ç»Ÿçš„åŒæ—¶æœ€å¤§ç¨‹åº¦é™ä½é£é™©ï¼Œç‰¹åˆ«é€‚åˆæµ·ä¸Šå…³é”®åº”ç”¨åœºæ™¯ã€‚