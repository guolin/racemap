# Feature 005: Trapezoid航线优化

> **创建时间**: 2025-01-12  
> **优先级**: P1 (中)  
> **估时**: 1天  
> **状态**: 待实施

## 📋 摘要

基于国际帆船比赛标准，优化现有的IO梯形航线，提供更专业的Trapezoid航线绘制功能，支持多种标准配置和灵活的航线布局。

## 🎯 航线绘制方法

### 标点定义
- **信号船**: 航线原点
- **左侧**: 垂直于主轴方向的左侧位置
- **1标**: 迎风标
- **2标**: 横风标
- **3S/3P**: 3标门标（右侧/左侧）
- **4S/4P**: 4标门标（右侧/左侧）

### 连线布局
1. **起航线**: 信号船 - 左侧
2. **leg1**: 起航线中点 - 1标
3. **leg2**: 1标 - 2标
4. **leg3**: 2标 - 3标（3S-3P连线中点）
5. **3标门标连线**: 3S - 3P（紫色虚线）
6. **4标门标连线**: 4S - 4P（紫色虚线）

注：leg4（3标到4标的连线）不显示，4标本身不显示，只显示4S/4P门标

### 位置计算规则
- **信号船**: 作为原点
- **左侧**: 垂直于主轴方向的左侧，与信号船的距离为起航线长度
- **1标**: 从起航线中点出发，沿主轴方向，距离为distanceNm
- **2标**: 从1标出发，沿1标到起航线中点的方向顺时针旋转interior度数，距离为distanceNm × leg2Ratio
- **3标**: 从2标出发，沿主轴反方向，距离为distanceNm × leg3Ratio，位置是3S-3P连线的中点
- **3S/3P**: 分别位于3标的右侧和左侧，垂直于主轴方向，间距为mark3GateWidth
- **4标**: 位于起航线中点到1标的连线上，距离起航线中点mark4DistanceNm（不显示4标本身）
- **4S/4P**: 分别位于4标的右侧和左侧，垂直于主轴方向，间距为mark4GateWidth

## 🔧 航线参数

### 核心几何参数
- **axis** (度): 0-360°，主轴方向（leg1方向）
- **distanceNm** (海里): 0.1-2.0海里，基础航线距离
- **startLineM** (米): 50-300米，起航线长度
- **interior** (度): 30-90°，从1标到起航线中点方向顺时针旋转到2标的角度，默认60°

### 航段长度倍数
- **leg2Ratio**: leg2长度倍数，默认1.0，范围0.8-1.2
- **leg3Ratio**: leg3长度倍数，默认1.0，范围0.8-1.2

### 标记位置
- **mark4DistanceNm** (海里): 4标距起航线中点的距离，默认0.02海里

### 门标宽度
- **mark3GateWidth** (米): 3标门宽度，20-200米，默认80米
- **mark4GateWidth** (米): 4标门宽度，20-200米，默认60米

## 🎨 视觉表现

### 航线颜色
- 起航线: 橙色 (#ff7f0e)
- leg1/leg2/leg3: 蓝色 (#1f77b4)
- 终点段: 红色 (#d62728)
- 门标连线: 紫色虚线 (#9467bd)


### 标记图标
- 信号船: S标记
- 标记1-2: 数字标记
- 门标: 3S、3P、4S、4P标记

## 📱 用户交互

支持实时参数调整，航线动态重绘，提供标准配置快速选择，满足不同风力条件下的航线设置需求。 